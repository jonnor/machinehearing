# Machine Hearing

Machine Hearing, or Machine Listening,
is the use of Machine Learning and audio sensors to derive meaningful information from sound.
This include listening for and diagnosing problems in machinery,
understanding events and activities that cause noise,
and estimation of how humans perceive certain sounds.

Here you can find some notes on the topic compiled by [Jon Nordby](http://jonnor.com).

![Soundsensing logo](./img/soundsensing-banner.png)

This research is sponsored by [Soundsensing](https://soundsensing.no),
a provider of IoT audio sensors with built-in Machine Learning, used for Noise Monitoring and Condition Monitoring.
The sensors are ideal for continious monitoring of audible noises and events, and can perform tasks such as
Audio Classification, Audio Event Detection and Acoustic Anomaly Detection.
Their sensors can transmit compressed and privacy-preserving spectrograms, allowing Machine Learning to be done in the cloud using familiar tools like Python.
Or models can be deployed onto the sensor itself, for a highly efficient on-edge ML solution.

# Recent work

## EuroPython 2021: Sound Event Detection with Machine Learning

<a href="https://youtu.be/JrhsFfCOL-s">
<img src="https://github.com/jonnor/machinehearing/raw/master/europython2021/cover.jpg" height="200" alt="Youtube: Sound Event Detection with Machine Learning (EuroPython 2021)">
</a>

July 26, 2021.
Presented at [EuroPython 2021](https://ep2021.europython.eu).
[Video recording](https://youtu.be/JrhsFfCOL-s), [slides](https://jonnor.github.io/machinehearing/europython2021/slides.html), [notes](./europython2021).

<!-- TODO, add ICSV27 presentation -->


## TinyML EMEA 2021: Perfect coffee roasting with TinyML sound sensing  

<a href="https://youtu.be/muZY1eCke40">
<img src="https://github.com/jonnor/machinehearing/raw/master/tinymlEMEA2021/cover.jpg" height="200" alt="Perfect coffee roasting with TinyML sound sensing">
</a>

June 7, 2021.
Presented at [tinyML EMEA Technical Forum 2021](https://www.tinyml.org/event/emea-2021/).
Video recording coming, [slides](https://jonnor.github.io/machinehearing/tinymlEMEA2021/slides.html), [notes](./tinymlEMEA2021).


## TinyML Summit 2021: Environmental Sound Classification on microcontrollers  

<a href="https://www.youtube.com/watch?v=cARhrotq5HA&t=0s">
<img src="https://github.com/jonnor/machinehearing/raw/master/tinyml2021/cover.jpg" height="200" alt="Environmental Sound Classification on microcontrollers">
</a>

March 25, 2021. [Video recording](https://www.youtube.com/watch?v=cARhrotq5HA&t=0s), [slides](https://jonnor.github.io/machinehearing/tinyml2021/slides.html), [notes](./tinyml2021).


## Classifying sound using Machine Learning

<a href="https://www.youtube.com/watch?v=1H63PewtDbo">
<img src="https://github.com/jonnor/machinehearing/raw/master/knowit2020/video.png" height="200" alt="Youtube: Classifying sound using Machine Learning">
</a>

At KnowIt Oslo, 2020. [Video recording](https://www.youtube.com/watch?v=1H63PewtDbo), [slides](https://jonnor.github.io/machinehearing/knowit2020/slides.html), [notes](./knowit2020)

## Environmental Sound Classification on Microcontrollers using Convolutional Neural Networks

<a href="https://github.com/jonnor/ESC-CNN-microcontroller">
<img src="https://github.com/jonnor/ESC-CNN-microcontroller/raw/master/report/img/frontpage.png" height="200" alt="Github: jonnor/ESC-CNN-microcontroller">
</a>

Master thesis. Report and code available in the [Github repository](https://github.com/jonnor/ESC-CNN-microcontroller).

## EuroPython2019: Audio Classification using Machine Learning

<a href="https://www.youtube.com/watch?v=uCGROOUO_wY">
<img src="https://github.com/jonnor/machinehearing/raw/master/europython2019/video.png" height="200" alt="Youtube: Audio Classification using Machine Learning by Jon Nordby, EuroPython 2019">
</a>

Presentation at EuroPython2019. [Video recording](https://www.youtube.com/watch?v=uCGROOUO_wY), [notes](./europython2019)

## PyCode2019: Recognizing sounds with Machine Learning and Python

<a href="https://jonnor.github.io/machinehearing/pycode2019/slides.html">
<img src="https://github.com/jonnor/machinehearing/raw/master/pycode2019/slides.png" height="200" alt="Slides">
</a>

<!--
<a href="https://youtu.be/2FmMESSD2CM?t=8470">
<img src="https://github.com/jonnor/machinehearing/raw/master/europython2019/video.png" height="200" alt="Youtube: Audio Classification using Machine Learning by Jon Nordby, EuroPython 2019">
</a>
-->

Presentation at PyCode Conference 2019 in Gdansk.
[Slides](https://jonnor.github.io/machinehearing/pycode2019/slides.html),
[notes](./pycode2019)

Video recording. Coming, maybe in November.

## SenseCamp2019: Classification of Environmental Sound using IoT sensors

<a href="https://jonnor.github.io/machinehearing/sensecamp2019/slides.html">
<img src="https://github.com/jonnor/machinehearing/raw/master/sensecamp2019/slides.png" height="200" alt="Slides">
</a>

Presentation at SenseCamp 2019 hosted by FORCE Technology Senselab.
Slides: [web](https://jonnor.github.io/machinehearing/sensecamp2019/slides.html),
[.PDF](https://github.com/jonnor/machinehearing/raw/master/sensecamp2019/slides.pdf)


## NMBU lecture on Audio Classification

Report and lecture at [NMBU](https://nmbu.no) Data Science.

[Report](https://github.com/jonnor/datascience-master/raw/master/dat390/merged.pdf) |
[Slides](https://jonnor.github.io/datascience-master/dat390/slides.html)


## Stack Overflow answers

With example code in Python

* [Loading Youtube audio data with youtube-dl and librosa](https://stackoverflow.com/a/57832701/1967571)
* [Extracting fixed-size analysis windows from audio](https://stackoverflow.com/a/54326750/1967571)
* [Classifying an audio clip of many analysis windows using Keras Timedistributed and GlobalAveragePooling](https://stackoverflow.com/a/55286629/1967571)
* [Classifying an audio clip by voting over analysis windows](https://stackoverflow.com/a/55267520/1967571). Mean/majority voting.
* [Annotating/labeling audio data using Audacity](https://datascience.stackexchange.com/a/56372/54096)
* [Preprocessing audio into mel-spectrograms](https://stats.stackexchange.com/a/403051/201327)
* [Multi-core preprocessing of audio files using joblib](https://stackoverflow.com/a/55680757/1967571)
* [Compute MFCC or mel-spectrogram from existing STFT spectrograms](https://stackoverflow.com/a/57833078/1967571)
* [Converting mel-spectrograms into PNG images](https://stackoverflow.com/a/57204349/1967571)
* [Converting mel-spectrogram or MFCC back to audio waveform using librosa](https://stackoverflow.com/a/57323359/1967571)

<!--
https://stackoverflow.com/questions/57443870/stream-binary-audio-data-from-http-request-for-librosa-analysis/57672134#57672134

Streaming audio from HTTP to for audio classification. Supports real-time streaming

Chunk download audio from Youtube.
Benefit: Can classify in parallel.
Can get a particular location in time

https://unix.stackexchange.com/questions/230481/how-to-download-portion-of-video-with-youtube-dl-command

-->

## Notes

Rough notes on various topics.

* [Applications](./applications.md). Practical applications of Machine Hearing
* [Tasks](./tasks.md). Established problem formulations
* [Audio Quality](./audio-quality). Metrics for measuring audio quality
* [Explainable models for Audio](./explainable).
* [Features](./features.md). Feature representations
* [Preprocessing](./preprocessing.md). Preprocessing techniques
* [DCASE2018](./dcase2018.md). Notes from DCASE2018 challenge and conference
* [Commercial solutions](./commercial.md). Companies and products in Machine Hearing
* [Speech](./speech.md). Speech-specific techniques and applications
* [Music](./music.md). Music-specific techniques and applications
* [Compressive Sensing](./compressive-sensing.md).

## Resources

Useful resources to learn more.

### Presentations

- [Audio Event Detection w/Deep Learning](https://www.youtube.com/watch?v=9X66iwEQSyI).
By Robert Coop, Ph.D, Head of AI and ML @ Stanley B&D.
From Data Science Connect, 2028.


### Books

* Computational Analysis of Sound Scenes and Events. Tuomas Virtanen, Mark D. Plumbley, Dan Ellis. 2018.
* Human and Machine Hearing - Extracting Meaning from Sound. Richard F. Lyon. 2017, revised 2018.
* An Introduction to Audio Content Analysis - Applications in Signal Processing and Music Informatics. Alexander Lerch. 2012.
Companion website: https://www.audiocontentanalysis.org/
* Machine Learning for Audio, Image and Video Analysis: Theory and Applications (Advanced Information and Knowledge Processing). Francesco Camastra, 
3 sections. From Perception to Computation, Machine Learning, Applications.

### Online courses

* CSC 83060: Speech and Audio Understanding. http://mr-pc.org/t/csc83060/
Brooklyn College (CUNY).
* [Deep Learning (for Audio) with Python](https://www.youtube.com/playlist?list=PL-wATfeyAMNrtbkCNsLcpoAyBBRJZVlnf) by Valerio Velardo
* [PyTorch for Audio + Music Processing](https://www.youtube.com/playlist?list=PL-wATfeyAMNoirN4idjev6aRu8ISZYVWm)  by Valerio Velardo

## Software

Feature extraction

* [librosa](http://librosa.github.io). The go-to Python module.
* [essentia](https://essentia.upf.edu). C++ library, with Python bindings. Lots of Music Analysis extractors. Used by FreeSound and Acousticbrainz.
* [kapre](https://github.com/keunwoochoi/kapre). On-demand GPU computation of melspectrograms, for Keras
* [torchaudio](https://pytorch.org/audio/stable/index.html). Audio processing in PyTorch 

Data Augmentation

* [muda: Python library for augmenting annotated audio data](https://github.com/bmcfee/muda)
* [audiomentations](https://github.com/iver56/audiomentations). 
* [scaper](https://github.com/justinsalamon/scaper). Soundscape synthesis tool with automatic label handling. 

# Lecture notes

* Audio Classification.
http://www.cs.tut.fi/~sgn24006/PDF/L04-audio-classification.pdf
Covers low-level features, MFCC. Classification by distance metrics. GMM. HMM.
* [Speech Signal Analysis, Lecture 2](https://www.inf.ed.ac.uk/teaching/courses/asr/2016-17/asr02-signal-handout.pdf).
January 2017, Hiroshi Shimodaira and Steve Renals.
! great diagrams of audio discretization, mel filters, wide versus narrow-band spectrograms.

## Competions

* Kaggle Whale detection
* Kaggle FreeSound tagging 2018
* Kaggle FreeSound
* DCASE2014
* DCASE2018
* DCASE2019
* DCASE2020
* DCASE2021 

## Datasets

* [Audio cats and dogs (Kaggle)](https://www.kaggle.com/mmoreaux/audio-cats-and-dogs)
* [Heartbeat anomalies (Kaggle)](https://www.kaggle.com/kinguistics/heartbeat-sounds).
* [Respiratory sounds (Kaggle)](https://www.kaggle.com/vbookshelf/respiratory-sound-database)

## Online Communities

* https://mircommunity.slack.com/ - Music Information Retrieval
* [The Sound of AI](https://valeriovelardo.com/the-sound-of-ai-community/), Slack Community

### Lists

* [Awesome Deep Learning Music](https://github.com/ybayle/awesome-deep-learning-music)
* [Fast.ai forums: Deep Learning with Audio](https://forums.fast.ai/t/deep-learning-with-audio-thread/38123).
Large lists of resources, both in first post and "popular links". Feb 2019, 315 replies over 4 months.




